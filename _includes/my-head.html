<!-- Hydejack hook: custom HTML injected into <head> on every page -->
<script>
  (function () {
    var ABOUT_URL = "{{ '/about/' | relative_url }}";
    var HOME_URL = "{{ '/' | relative_url }}";

    function normalizeHref(href) {
      if (!href) return '';
      // Strip origin if present
      try {
        var url = new URL(href, window.location.origin);
        return url.pathname + (url.search || '') + (url.hash || '');
      } catch (e) {
        return href;
      }
    }

    function rewriteSidebarHomeToAbout() {
      // Only touch links inside Hydejack's sidebar
      var sidebar = document.getElementById('_sidebar') || document.querySelector('header.sidebar');
      if (!sidebar) return;

      var candidates = sidebar.querySelectorAll('.sidebar-about a[href]');
      for (var i = 0; i < candidates.length; i++) {
        var a = candidates[i];
        var href = a.getAttribute('href');
        var normalized = normalizeHref(href);

        if (normalized === '/' || normalized === HOME_URL) {
          a.setAttribute('href', ABOUT_URL);
        }
      }
    }

    // Initial load
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', rewriteSidebarHomeToAbout);
    } else {
      rewriteSidebarHomeToAbout();
    }

    // Hydejack SPA navigation
    var pushStateEl = document.getElementById('_pushState');
    if (pushStateEl && pushStateEl.addEventListener) {
      pushStateEl.addEventListener('hy-push-state-after', rewriteSidebarHomeToAbout);
      pushStateEl.addEventListener('hy-push-state-ready', rewriteSidebarHomeToAbout);
    }
  })();
</script>
